{
  "hash": "103d9c7702ea7b3732ced21bafd561cb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Extracting Data from PDFs documents using tabulapdf in R\"\nsubtitle: \"Part 2\"\nauthor: \"[Muhammad Yaseen](https://myaseen208.com/), [Zahid Asghar](https://zahid.quarto.pub/) \"\ndate: \"2024-06-12\"\ncategories: [R, PDF, Data Extraction]\nformat: \n  html:\n    toc: true\n    toc-float: true\n    toc_depth: 3\n    code_folding: show\n    number_sections: true\n    highlight-style: dracula\neditor: visual\nexecute: \n  freeze: auto\n  warning: false\n  message: false\n---\n\n\n\n## Introduction\n\nIn the [part 1](https://zahid.quarto.pub/pdf-table/myR/pdf_tables/) of extracting pdf tables, we discussed how to extract data from PDF files using the `tabulapdf` package in R. In this part, we will explore little more for extracting data from PDFs. We will also discuss how to handle more complex tables and extract data from PDFs.\n\nWe have same libraries as in the first part. \n\n\n## Required Libraries\n\nI have tried `tabulizer` to install but not successful. I have come across `tabulapdf` package and find it very handy. To begin, we'll need to install and load the necessary libraries. Here is the list of packages we'll be using:\n\n- `rJava`\n- `tabulapdf`\n- `pdftools`\n- `tidyverse`\n\nLet's load these libraries in R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSys.setenv(JAVA_HOME = \"C:/Program Files/Java/jdk-22\") ## One check is for one's system if required for running `rJava`\nlibrary(rJava)\nlibrary(tabulapdf)\nlibrary(pdftools)\nlibrary(tidyverse)\n```\n:::\n\n\n\n## Extracting Tables from a PDF \n\n\n\n\n\nNow we will extract a table from page 10 from the same PDF file as in part 1. This PDF is a monthly report on Consumer Price Index from the Pakistan Bureau of Statistics.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# URL of the monthly review PDF\nf1 <- \"https://www.pbs.gov.pk/sites/default/files/price_statistics/cpi/may/Monthly%20Review%20May%2C%202024.pdf\"\n```\n:::\n\n\n\n\n::: {#fig-cpi}\n\n![](cpi8.png)\n\nConsumer Price Index (National) by Group of Commodities and Services (Base 2015-16) \n::: \n\nOne can see from @fig-cpi that the table we want to extract is on the third page of the PDF. Let's extract the table from the third page of the PDF file.\n\n\n\n::: {#tbl-cpi .cell tbl-cap='Extracted Table from the PDF'}\n\n```{.r .cell-code}\n# Extract and view the table from the third page of the PDF\nextract_tables(f1, pages =8 )[[1]] |> kableExtra::kable() |> kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = F)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Table 1: Consumer Price Index (National) by Group of Commodities and Services (Base 2015-16) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> % Change Impact </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Group Indices May 2024 (In % points) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Group Weight Over May 2024 Over </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> No  (%) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> May 24 April 24 May 23 April 24 May 23 April 24 May 23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> General 100.00 254.78 263.32 227.96 -3.24 11.76 -3.24 11.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1. Food &amp; Non-alcoholic Bev. 34.58 264.01 286.43 264.45 -7.83 -0.17 -2.94 -0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Non-perishable Food Items 29.60 266.43 282.07 271.20 -5.54 -1.76 -1.76 -0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Perishable Food Items 4.99 249.59 312.36 224.41 -20.10 11.22 -1.19 0.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2. Alcoholic Bev. &amp; Tobacco 1.02 366.68 366.07 356.40 0.17 2.88 0.00 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3. Clothing &amp; Footwear 8.60 239.46 238.38 202.95 0.46 17.99 0.04 1.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Housing, Water, Electricity, </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 4. 23.63 236.63 239.81 177.92 -1.33 33.00 -0.29 6.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gas &amp; Fuels </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Furnishing &amp; Household </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 5. 4.10 267.41 266.41 235.09 0.37 13.75 0.02 0.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Equipment Maintenance </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 6. Health 2.79 241.17 237.29 201.94 1.63 19.42 0.04 0.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 7. Transport 5.91 315.06 320.28 285.36 -1.63 10.41 -0.12 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 8. Communication 2.21 134.27 134.85 118.27 -0.43 13.53 0.00 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 9. Recreation &amp; Culture 1.59 262.27 258.77 242.93 1.35 7.96 0.02 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 10. Education 3.79 199.00 196.20 171.63 1.43 15.95 0.04 0.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 11. Restaurants &amp; Hotels 6.92 267.22 269.38 235.03 -0.80 13.70 -0.06 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 12. Miscellaneous 4.87 282.79 282.22 246.64 0.20 14.66 0.01 0.77 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n@tbl-cpi is extracted from the PDF file in the same way as in [Part 1](https://zahid.quarto.pub/pdf-table/myR/pdf_tables/). But all the data is in one column. One can adjust it as per requirement by some more coding. But we are showing an easy way to extract such data.\nWe shall use first command `get_page_dims` to get the dimensions of the page and then use `area` to extract the table. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_page_dims(f1, pages = 8)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[[1]]\n[1] 595.32 841.92\n```\n\n\n:::\n:::\n\n\n\nAfter getting page dimensions, we can extract the table by specifying the area of the table. One has to do some minor adjustments to get the desired table by specifying four values `top`, `left`, `bottom`, and `right`. \n\n\n\n\n\n\n::: {#tbl-cpi1 .cell tbl-cap='Extracted Table from the PDF with specified area'}\n\n```{.r .cell-code}\nlibrary(data.table)\nData1 <-\n  extract_tables(\n    file  = f1\n    , pages = 8\n    , area  = list(c(180, 84, 470, 855)) # (top, left, bottom, right)\n    , guess = FALSE\n  ) [[1]] %>%\n  as.data.table()\n\nData1 |> kableExtra::kable() |> kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = F) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ...1 </th>\n   <th style=\"text-align:right;\"> ...2 </th>\n   <th style=\"text-align:right;\"> May 24 </th>\n   <th style=\"text-align:right;\"> April 24...4 </th>\n   <th style=\"text-align:right;\"> May 23...5 </th>\n   <th style=\"text-align:right;\"> April 24...6 </th>\n   <th style=\"text-align:right;\"> May 23...7 </th>\n   <th style=\"text-align:right;\"> April 24...8 </th>\n   <th style=\"text-align:right;\"> May 23...9 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> General </td>\n   <td style=\"text-align:right;\"> 100.00 </td>\n   <td style=\"text-align:right;\"> 254.78 </td>\n   <td style=\"text-align:right;\"> 263.32 </td>\n   <td style=\"text-align:right;\"> 227.96 </td>\n   <td style=\"text-align:right;\"> -3.24 </td>\n   <td style=\"text-align:right;\"> 11.76 </td>\n   <td style=\"text-align:right;\"> -3.24 </td>\n   <td style=\"text-align:right;\"> 11.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Food &amp; Non-alcoholic Bev. </td>\n   <td style=\"text-align:right;\"> 34.58 </td>\n   <td style=\"text-align:right;\"> 264.01 </td>\n   <td style=\"text-align:right;\"> 286.43 </td>\n   <td style=\"text-align:right;\"> 264.45 </td>\n   <td style=\"text-align:right;\"> -7.83 </td>\n   <td style=\"text-align:right;\"> -0.17 </td>\n   <td style=\"text-align:right;\"> -2.94 </td>\n   <td style=\"text-align:right;\"> -0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Non-perishable Food Items </td>\n   <td style=\"text-align:right;\"> 29.60 </td>\n   <td style=\"text-align:right;\"> 266.43 </td>\n   <td style=\"text-align:right;\"> 282.07 </td>\n   <td style=\"text-align:right;\"> 271.20 </td>\n   <td style=\"text-align:right;\"> -5.54 </td>\n   <td style=\"text-align:right;\"> -1.76 </td>\n   <td style=\"text-align:right;\"> -1.76 </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Perishable Food Items </td>\n   <td style=\"text-align:right;\"> 4.99 </td>\n   <td style=\"text-align:right;\"> 249.59 </td>\n   <td style=\"text-align:right;\"> 312.36 </td>\n   <td style=\"text-align:right;\"> 224.41 </td>\n   <td style=\"text-align:right;\"> -20.10 </td>\n   <td style=\"text-align:right;\"> 11.22 </td>\n   <td style=\"text-align:right;\"> -1.19 </td>\n   <td style=\"text-align:right;\"> 0.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Alcoholic Bev. &amp; Tobacco </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 366.68 </td>\n   <td style=\"text-align:right;\"> 366.07 </td>\n   <td style=\"text-align:right;\"> 356.40 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 2.88 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Clothing &amp; Footwear </td>\n   <td style=\"text-align:right;\"> 8.60 </td>\n   <td style=\"text-align:right;\"> 239.46 </td>\n   <td style=\"text-align:right;\"> 238.38 </td>\n   <td style=\"text-align:right;\"> 202.95 </td>\n   <td style=\"text-align:right;\"> 0.46 </td>\n   <td style=\"text-align:right;\"> 17.99 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 1.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Housing, Water, Electricity, </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 23.63 </td>\n   <td style=\"text-align:right;\"> 236.63 </td>\n   <td style=\"text-align:right;\"> 239.81 </td>\n   <td style=\"text-align:right;\"> 177.92 </td>\n   <td style=\"text-align:right;\"> -1.33 </td>\n   <td style=\"text-align:right;\"> 33.00 </td>\n   <td style=\"text-align:right;\"> -0.29 </td>\n   <td style=\"text-align:right;\"> 6.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Gas &amp; Fuels </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Furnishing &amp; Household </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> NA </td>\n   <td style=\"text-align:right;\"> 4.10 </td>\n   <td style=\"text-align:right;\"> 267.41 </td>\n   <td style=\"text-align:right;\"> 266.41 </td>\n   <td style=\"text-align:right;\"> 235.09 </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n   <td style=\"text-align:right;\"> 13.75 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Equipment Maintenance </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Health </td>\n   <td style=\"text-align:right;\"> 2.79 </td>\n   <td style=\"text-align:right;\"> 241.17 </td>\n   <td style=\"text-align:right;\"> 237.29 </td>\n   <td style=\"text-align:right;\"> 201.94 </td>\n   <td style=\"text-align:right;\"> 1.63 </td>\n   <td style=\"text-align:right;\"> 19.42 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Transport </td>\n   <td style=\"text-align:right;\"> 5.91 </td>\n   <td style=\"text-align:right;\"> 315.06 </td>\n   <td style=\"text-align:right;\"> 320.28 </td>\n   <td style=\"text-align:right;\"> 285.36 </td>\n   <td style=\"text-align:right;\"> -1.63 </td>\n   <td style=\"text-align:right;\"> 10.41 </td>\n   <td style=\"text-align:right;\"> -0.12 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Communication </td>\n   <td style=\"text-align:right;\"> 2.21 </td>\n   <td style=\"text-align:right;\"> 134.27 </td>\n   <td style=\"text-align:right;\"> 134.85 </td>\n   <td style=\"text-align:right;\"> 118.27 </td>\n   <td style=\"text-align:right;\"> -0.43 </td>\n   <td style=\"text-align:right;\"> 13.53 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Recreation &amp; Culture </td>\n   <td style=\"text-align:right;\"> 1.59 </td>\n   <td style=\"text-align:right;\"> 262.27 </td>\n   <td style=\"text-align:right;\"> 258.77 </td>\n   <td style=\"text-align:right;\"> 242.93 </td>\n   <td style=\"text-align:right;\"> 1.35 </td>\n   <td style=\"text-align:right;\"> 7.96 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Education </td>\n   <td style=\"text-align:right;\"> 3.79 </td>\n   <td style=\"text-align:right;\"> 199.00 </td>\n   <td style=\"text-align:right;\"> 196.20 </td>\n   <td style=\"text-align:right;\"> 171.63 </td>\n   <td style=\"text-align:right;\"> 1.43 </td>\n   <td style=\"text-align:right;\"> 15.95 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Restaurants &amp; Hotels </td>\n   <td style=\"text-align:right;\"> 6.92 </td>\n   <td style=\"text-align:right;\"> 267.22 </td>\n   <td style=\"text-align:right;\"> 269.38 </td>\n   <td style=\"text-align:right;\"> 235.03 </td>\n   <td style=\"text-align:right;\"> -0.80 </td>\n   <td style=\"text-align:right;\"> 13.70 </td>\n   <td style=\"text-align:right;\"> -0.06 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Miscellaneous </td>\n   <td style=\"text-align:right;\"> 4.87 </td>\n   <td style=\"text-align:right;\"> 282.79 </td>\n   <td style=\"text-align:right;\"> 282.22 </td>\n   <td style=\"text-align:right;\"> 246.64 </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 14.66 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n@tbl-cpi1 is almost the same as reported in @fig-cpi unlike @tbl-cpi which has all data in one column. However, some adjustments are still required. We have first column names with some specific symbols so its names are spread in more than one rows. To remove rows with NAs and adjusting row names, we can do some wrangling. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(Data1) <- c(\"Group\", \" Group Weight\", \"index_may_2024\", \"index_apr_2024\", \"index_may_2023\", \"index_may_2024_mom\", \"index_may_2024_yoy\",\n                      \"impact_apr_2024\", \"impact_may_2023\")\nData2 <- Data1 %>%\n  mutate(\n    Group = case_when(\n      is.na(Group) & row_number() == 8 ~ \"Housing, Water, Electricity, Gas & Other\",\n      is.na(Group) & row_number() == 11 ~ \"Furnishing & Household Equip. & Maintenance\",\n      TRUE ~ Group\n    )\n  )\n```\n:::\n\n::: {#tbl-cpi2 .cell tbl-cap='Cleaned Data Frame'}\n\n```{.r .cell-code}\n## Remove rows with missing values\n\nData3 <- Data2 |> drop_na()\n\n## Cleaned Data Frame\nData3 |> kableExtra::kable() |> kableExtra::kable_styling(bootstrap_options = c(\"striped\", \"hover\", \"condensed\", \"responsive\"), full_width = F) \n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover table-condensed table-responsive\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Group </th>\n   <th style=\"text-align:right;\"> Group Weight </th>\n   <th style=\"text-align:right;\"> index_may_2024 </th>\n   <th style=\"text-align:right;\"> index_apr_2024 </th>\n   <th style=\"text-align:right;\"> index_may_2023 </th>\n   <th style=\"text-align:right;\"> index_may_2024_mom </th>\n   <th style=\"text-align:right;\"> index_may_2024_yoy </th>\n   <th style=\"text-align:right;\"> impact_apr_2024 </th>\n   <th style=\"text-align:right;\"> impact_may_2023 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> General </td>\n   <td style=\"text-align:right;\"> 100.00 </td>\n   <td style=\"text-align:right;\"> 254.78 </td>\n   <td style=\"text-align:right;\"> 263.32 </td>\n   <td style=\"text-align:right;\"> 227.96 </td>\n   <td style=\"text-align:right;\"> -3.24 </td>\n   <td style=\"text-align:right;\"> 11.76 </td>\n   <td style=\"text-align:right;\"> -3.24 </td>\n   <td style=\"text-align:right;\"> 11.76 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Food &amp; Non-alcoholic Bev. </td>\n   <td style=\"text-align:right;\"> 34.58 </td>\n   <td style=\"text-align:right;\"> 264.01 </td>\n   <td style=\"text-align:right;\"> 286.43 </td>\n   <td style=\"text-align:right;\"> 264.45 </td>\n   <td style=\"text-align:right;\"> -7.83 </td>\n   <td style=\"text-align:right;\"> -0.17 </td>\n   <td style=\"text-align:right;\"> -2.94 </td>\n   <td style=\"text-align:right;\"> -0.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Non-perishable Food Items </td>\n   <td style=\"text-align:right;\"> 29.60 </td>\n   <td style=\"text-align:right;\"> 266.43 </td>\n   <td style=\"text-align:right;\"> 282.07 </td>\n   <td style=\"text-align:right;\"> 271.20 </td>\n   <td style=\"text-align:right;\"> -5.54 </td>\n   <td style=\"text-align:right;\"> -1.76 </td>\n   <td style=\"text-align:right;\"> -1.76 </td>\n   <td style=\"text-align:right;\"> -0.62 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Perishable Food Items </td>\n   <td style=\"text-align:right;\"> 4.99 </td>\n   <td style=\"text-align:right;\"> 249.59 </td>\n   <td style=\"text-align:right;\"> 312.36 </td>\n   <td style=\"text-align:right;\"> 224.41 </td>\n   <td style=\"text-align:right;\"> -20.10 </td>\n   <td style=\"text-align:right;\"> 11.22 </td>\n   <td style=\"text-align:right;\"> -1.19 </td>\n   <td style=\"text-align:right;\"> 0.55 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Alcoholic Bev. &amp; Tobacco </td>\n   <td style=\"text-align:right;\"> 1.02 </td>\n   <td style=\"text-align:right;\"> 366.68 </td>\n   <td style=\"text-align:right;\"> 366.07 </td>\n   <td style=\"text-align:right;\"> 356.40 </td>\n   <td style=\"text-align:right;\"> 0.17 </td>\n   <td style=\"text-align:right;\"> 2.88 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Clothing &amp; Footwear </td>\n   <td style=\"text-align:right;\"> 8.60 </td>\n   <td style=\"text-align:right;\"> 239.46 </td>\n   <td style=\"text-align:right;\"> 238.38 </td>\n   <td style=\"text-align:right;\"> 202.95 </td>\n   <td style=\"text-align:right;\"> 0.46 </td>\n   <td style=\"text-align:right;\"> 17.99 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 1.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Housing, Water, Electricity, Gas &amp; Other </td>\n   <td style=\"text-align:right;\"> 23.63 </td>\n   <td style=\"text-align:right;\"> 236.63 </td>\n   <td style=\"text-align:right;\"> 239.81 </td>\n   <td style=\"text-align:right;\"> 177.92 </td>\n   <td style=\"text-align:right;\"> -1.33 </td>\n   <td style=\"text-align:right;\"> 33.00 </td>\n   <td style=\"text-align:right;\"> -0.29 </td>\n   <td style=\"text-align:right;\"> 6.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Furnishing &amp; Household Equip. &amp; Maintenance </td>\n   <td style=\"text-align:right;\"> 4.10 </td>\n   <td style=\"text-align:right;\"> 267.41 </td>\n   <td style=\"text-align:right;\"> 266.41 </td>\n   <td style=\"text-align:right;\"> 235.09 </td>\n   <td style=\"text-align:right;\"> 0.37 </td>\n   <td style=\"text-align:right;\"> 13.75 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Health </td>\n   <td style=\"text-align:right;\"> 2.79 </td>\n   <td style=\"text-align:right;\"> 241.17 </td>\n   <td style=\"text-align:right;\"> 237.29 </td>\n   <td style=\"text-align:right;\"> 201.94 </td>\n   <td style=\"text-align:right;\"> 1.63 </td>\n   <td style=\"text-align:right;\"> 19.42 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.48 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Transport </td>\n   <td style=\"text-align:right;\"> 5.91 </td>\n   <td style=\"text-align:right;\"> 315.06 </td>\n   <td style=\"text-align:right;\"> 320.28 </td>\n   <td style=\"text-align:right;\"> 285.36 </td>\n   <td style=\"text-align:right;\"> -1.63 </td>\n   <td style=\"text-align:right;\"> 10.41 </td>\n   <td style=\"text-align:right;\"> -0.12 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Communication </td>\n   <td style=\"text-align:right;\"> 2.21 </td>\n   <td style=\"text-align:right;\"> 134.27 </td>\n   <td style=\"text-align:right;\"> 134.85 </td>\n   <td style=\"text-align:right;\"> 118.27 </td>\n   <td style=\"text-align:right;\"> -0.43 </td>\n   <td style=\"text-align:right;\"> 13.53 </td>\n   <td style=\"text-align:right;\"> 0.00 </td>\n   <td style=\"text-align:right;\"> 0.16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Recreation &amp; Culture </td>\n   <td style=\"text-align:right;\"> 1.59 </td>\n   <td style=\"text-align:right;\"> 262.27 </td>\n   <td style=\"text-align:right;\"> 258.77 </td>\n   <td style=\"text-align:right;\"> 242.93 </td>\n   <td style=\"text-align:right;\"> 1.35 </td>\n   <td style=\"text-align:right;\"> 7.96 </td>\n   <td style=\"text-align:right;\"> 0.02 </td>\n   <td style=\"text-align:right;\"> 0.13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Education </td>\n   <td style=\"text-align:right;\"> 3.79 </td>\n   <td style=\"text-align:right;\"> 199.00 </td>\n   <td style=\"text-align:right;\"> 196.20 </td>\n   <td style=\"text-align:right;\"> 171.63 </td>\n   <td style=\"text-align:right;\"> 1.43 </td>\n   <td style=\"text-align:right;\"> 15.95 </td>\n   <td style=\"text-align:right;\"> 0.04 </td>\n   <td style=\"text-align:right;\"> 0.45 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Restaurants &amp; Hotels </td>\n   <td style=\"text-align:right;\"> 6.92 </td>\n   <td style=\"text-align:right;\"> 267.22 </td>\n   <td style=\"text-align:right;\"> 269.38 </td>\n   <td style=\"text-align:right;\"> 235.03 </td>\n   <td style=\"text-align:right;\"> -0.80 </td>\n   <td style=\"text-align:right;\"> 13.70 </td>\n   <td style=\"text-align:right;\"> -0.06 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Miscellaneous </td>\n   <td style=\"text-align:right;\"> 4.87 </td>\n   <td style=\"text-align:right;\"> 282.79 </td>\n   <td style=\"text-align:right;\"> 282.22 </td>\n   <td style=\"text-align:right;\"> 246.64 </td>\n   <td style=\"text-align:right;\"> 0.20 </td>\n   <td style=\"text-align:right;\"> 14.66 </td>\n   <td style=\"text-align:right;\"> 0.01 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n@tbl-cpi2 is the cleaned data frame. We have adjusted column names and removed rows with missing values. One can use columns names as per one's requirement.\n\n## Saving the Data to a CSV File and Excel File\n\nFinally, we can save the cleaned data to a CSV and excel file for future use.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite.csv(Data3, \"CPI.csv\", row.names = FALSE)\nwritexl::write_xlsx(Data3, \"CPI.xlsx\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}